<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YT Processor | Viralio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = { theme: { extend: { colors: { primary: '#6366f1', dark: '#030712' } } } }
    </script>
    <style>
        body { background-color: #030712; color: white; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
        /* Scrollbar customizat pentru panourile de text */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f1423; border-radius: 8px; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 8px; }
        ::-webkit-scrollbar-thumb:hover { background: #4B5563; }
    </style>
</head>
<body class="p-6 md:p-12 relative overflow-hidden min-h-screen">
    
    <div class="absolute top-0 right-1/4 w-96 h-96 bg-red-500/10 rounded-full blur-[120px] pointer-events-none"></div>

    <a href="/" class="text-gray-400 hover:text-white mb-8 inline-flex items-center gap-2 font-medium transition relative z-10">
        <i class="fas fa-arrow-left"></i> Înapoi la Dashboard
    </a>
    
    <div class="max-w-6xl mx-auto glass rounded-[2rem] p-8 md:p-12 shadow-2xl relative z-10">
        <div class="text-center mb-10">
            <div class="w-16 h-16 rounded-2xl bg-red-500/20 text-red-500 flex items-center justify-center text-3xl mx-auto mb-6">
                <i class="fab fa-youtube"></i>
            </div>
            <h1 class="text-4xl font-extrabold mb-3">YT Downloader & Translator</h1>
            <p class="text-gray-400 text-lg">Introdu link-ul de YouTube pentru Video MP4 și Traducere.</p>
        </div>

        <div class="relative mb-6 group max-w-4xl mx-auto">
            <div class="absolute inset-y-0 left-0 pl-5 flex items-center pointer-events-none text-gray-500">
                <i class="fas fa-link"></i>
            </div>
            <input type="text" id="yt-url" placeholder="Lipește link-ul aici..." class="w-full bg-[#0f1423] border border-gray-800 rounded-2xl py-5 pl-12 pr-40 text-lg focus:outline-none focus:border-primary transition-all text-white placeholder-gray-600 shadow-inner">
            <button id="run-btn" class="absolute right-2 top-2 bottom-2 bg-primary hover:bg-indigo-500 text-white px-8 rounded-xl font-bold transition-all flex items-center gap-2 shadow-[0_0_20px_rgba(99,102,241,0.3)]">
                START <i class="fas fa-bolt"></i>
            </button>
        </div>

        <div id="loader" class="hidden text-center py-12">
            <div class="relative w-20 h-20 mx-auto mb-6">
                <div class="absolute inset-0 rounded-full border-t-2 border-primary animate-spin"></div>
                <div class="absolute inset-2 rounded-full border-r-2 border-pink-500 animate-spin" style="animation-direction: reverse; animation-duration: 1.5s;"></div>
                <i class="fas fa-language absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-gray-400 text-xl"></i>
            </div>
            <h3 class="text-xl font-bold text-white mb-2">Se descarcă și se traduce...</h3>
            <p class="text-gray-500">Folosim IP Rezidențial, poate dura câteva secunde.</p>
        </div>

        <div id="result" class="hidden mt-10 space-y-6">
            
            <div class="flex justify-center mb-8">
                <a id="dl-video" href="#" download class="flex items-center justify-center gap-3 bg-green-500 hover:bg-green-600 text-white px-10 py-5 rounded-2xl font-black text-xl transition-all hover:scale-105 shadow-[0_0_30px_rgba(34,197,94,0.4)]">
                    <i class="fas fa-download"></i> DESCARCĂ VIDEO MP4
                </a>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-[#0f1423] rounded-2xl border border-gray-800 h-[500px] flex flex-col overflow-hidden relative">
                    <div class="flex items-center gap-3 p-5 border-b border-gray-800 bg-[#151b2b]">
                        <div class="p-2 bg-blue-500/20 rounded-lg text-blue-400"><i class="fas fa-closed-captioning"></i></div>
                        <h4 class="font-bold text-gray-200">Subtitrare Originală</h4>
                    </div>
                    <div class="p-6 overflow-y-auto flex-1">
                        <p id="original-text" class="text-sm text-gray-400 leading-relaxed font-medium whitespace-pre-wrap"></p>
                    </div>
                </div>

                <div class="bg-[#0f1423] rounded-2xl border border-gray-800 h-[500px] flex flex-col overflow-hidden relative">
                    <div class="flex items-center gap-3 p-5 border-b border-gray-800 bg-[#151b2b]">
                        <div class="p-2 bg-pink-500/20 rounded-lg text-pink-400"><i class="fas fa-language"></i></div>
                        <h4 class="font-bold text-gray-200">Traducere (RO)</h4>
                    </div>
                    <div class="p-6 overflow-y-auto flex-1">
                        <p id="translated-text" class="text-sm text-gray-300 leading-relaxed font-medium whitespace-pre-wrap"></p>
                    </div>
                </div>
            </div>

        </div>

        <p id="error-msg" class="hidden mt-6 bg-red-500/10 border border-red-500/30 text-red-400 p-4 rounded-xl text-center font-bold"></p>
    </div>

    <script>
        document.getElementById('run-btn').addEventListener('click', async () => {
            const urlInput = document.getElementById('yt-url');
            const url = urlInput.value.trim();
            
            if (!url) return alert('Te rog introdu un link valid!');

            const btn = document.getElementById('run-btn');
            const loader = document.getElementById('loader');
            const result = document.getElementById('result');
            const errorMsg = document.getElementById('error-msg');

            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            loader.classList.remove('hidden');
            result.classList.add('hidden');
            errorMsg.classList.add('hidden');

            try {
                const backendUrl = '/api/process-yt';
                
                const res = await fetch(backendUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ url })
                });
                
                const responseText = await res.text();
                let data;
                try {
                    data = JSON.parse(responseText);
                } catch (e) {
                    throw new Error("Eroare de la server (Posibil Timeout/Proxy Error).");
                }

                if (!res.ok) throw new Error(data.error || "Eroare necunoscută.");

                // Actualizam UI-ul cu noile date primite de la backend
                document.getElementById('dl-video').href = data.downloadUrl;
                document.getElementById('original-text').innerText = data.originalText;
                document.getElementById('translated-text').innerText = data.translatedText;
                
                result.classList.remove('hidden');
            } catch (err) {
                errorMsg.innerText = "Eroare: " + err.message;
                errorMsg.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'START <i class="fas fa-bolt"></i>';
                loader.classList.add('hidden');
            }
        });
    </script>
</body>
</html>